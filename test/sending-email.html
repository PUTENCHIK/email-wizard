<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
</head>
<body>
<a href="#" onclick="myFunction()">Клик</a>
<script>
function myFunction() {
var mailHtm =`
<html xmlns="http://www.w3.org/2024/xhtml">
  <head>
  <meta charset="utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>HTML Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      body {
        width: 100% !important;
        -webkit-text-size-adjust: 100%;
        -ms-text-size-adjust: 100%;
        margin: 0;
        padding: 0;
        line-height: 100%;
        color: #022027;
      }

      [style*="Open Sans"] {
        font-family: 'Open Sans', arial, sans-serif !important;
      }

      img {
        outline: none;
        text-decoration: none;
        border: none;
        -ms-interpolation-mode: bicubic;
        max-width: 100%!important;
        margin: 0;
        padding: 0;
        display: block;
      }

      table td {
        border-collapse: collapse;
      }

      table {
        border-collapse: collapse;
        mso-table-lspace: 20pt;
        mso-table-rspace: 20pt;
      }

      .menu a {
        font-size: 18px;
        font-weight: 400;
        letter-spacing: 0.28px;
        text-decoration: none;
      }
      .S a{
        font-size: 20px;
        font-weight: 400;
        letter-spacing: 0.28px;
        text-decoration: none;
      }
      .P a{
        font-size: 12px;
        font-weight: 400;
        letter-spacing: 0.28px;
        text-decoration: none;
        color: #022027;
      }
      .S td{
        font-size: 20px;
        font-weight: 400;
        letter-spacing: 0.28px;
        line-height: 1.7;
        text-decoration: none;
      }

      .menu td {
        padding-left: 30px;
      }

      .things a {
        font-size: 18px;
        font-weight: 400;
        letter-spacing: 0.28px;
        text-decoration: none;
        color: red;
      }
      .genius p{
        line-height: 2;
      }
      .who{
        color: #D3D3D3
      }
      .things img {
        border: 5px solid red;
      }
     </style>
  </head>

  <body style="margin: 0; padding: 0;" bgcolor="white">
    <div style="font-size:0px;font-color:#ffffff;opacity:0;visibility:hidden;width:0;height:0;display:none;">Тестовое письмо</div>
    <table cellpadding="0" cellspacing="0" width="100%" bgcolor="white">
      <tr>
        <td>
          <table cellpadding="0" cellspacing="0" width="850" align="center">
              <tr>
                <td>
                    <table class="things" cellpading="0" cellspacing="0" width="850" height="0" align="center" bgcolor="#ffffff"></table>
                </td>
              </tr>
              <tr>
                <td>
                  <table class="table-600" cellpading="0" cellspacing="0" width="850" align="center" bgcolor="#30D5C8">
                    <tr>
                        <td>
                            <table class="things" cellpading="0" cellspacing="0" width="850" height="25" align="center"></table>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <table class="things" cellpading="0" cellspacing="0" width="850" height="45" align="center"></table>
                        </td>
                    </tr>
                    <tr>
                      <td align="center">
                        <table class="header-td S" width ="750">
                            <tr cellpading="0" cellspacing="0" align="center" valign="top">
                                <td align="center">
                                    <table>
                                        <tr cellpading="0" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; color: white;">Интернет поддержка</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="left" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';"> Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="left" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Сверхгениальная возможность</a></td>
                                        </tr>
                                    </table>
                                </td>
                                <td align="center">
                                    <table>
                                        <tr cellpading="0" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; color: white;">Поддержка</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';"> Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Сверхгениальная возможность</a></td>
                                        </tr>
                                    </table>
                                </td>
                                <td align="center">
                                    <table>
                                        <tr cellpading="0" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; color: white;">Кампания</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; "> Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Возможности</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; ">Сверхгениальная возможность</a></td>
                                        </tr>
                                    </table>
                                </td>
                                <td align="center">
                                    <table>
                                        <tr cellpading="0" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway'; color: white;">Сообщество</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';"> Телеграмм</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Вк</a></td>
                                        </tr>
                                        <tr cellpading="0" class="P" cellspacing="0" align="left">
                                            <td><a href="#" align="center" align="center" style="font-family: Arial, Helvetica, sans-serif, 'Raleway';">Одноклассники</a></td>
                                        </tr>
                                    </table>
                                </td>
                            </tr>
                            <tr height="30">
                            </tr>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><img align="right" src="https://vinyl-market.ru/images/shop_items/432-3.jpg.webp" height="35"/><td></td>
                            </tr>
                        </table>
                        </td>
                    </tr>
                  </table>
                  </td>
              </tr>
              <tr>
                <td>
                    <table class="things" cellpading="0" cellspacing="0" width="852 " height="55" align="center" bgcolor="#30D5C8"></table>
                </td>
              </tr>
              <tr>
                <td>
                  <table class="table-600" cellpading="0" cellspacing="0" width="844" align="center" bgcolor="black">
                    <tr>
                        <td>
                            <table class="things" cellpading="0" cellspacing="0" width="850" height="15" align="center"></table>
                        </td>
                      </tr>
                    <tr>
                      <td align="center">
                        <table class="header-td S" width ="750" cellpading="0" cellspacing="0" align="center">

                            <tr valign="top">
                                <td>
                                    <table cellpading="0" cellspacing="0" width="750">
                                        <tr cellpading="0" cellspacing="0" width="750" align="center">
                                            <td align="left">
                                            <table cellpading="0" cellspacing="0">
                                                <tr>
                                                    <td align="left" bgcolor="darkgray"><img src="https://cdn-icons-png.flaticon.com/512/3081/3081797.png" height="35"/></td>
                                                    <td align="left" style="color: white; font-size: 16px;">@2024 Шелби </td>

                                                </tr>
                                            </table>
                                            </td>
                                            <td align="center">
                                                <table cellpading="0" cellspacing="0" style="border-spacing: 20px;border-collapse: separate;">
                                                    <tr>
                                                        <td align="center"><img src="https://w7.pngwing.com/pngs/110/123/png-transparent-iphone-ipad-android-google-play-now-button-electronics-text-logo.png" height="35"/></td>
                                                        <td align="center"><img src="https://i-invdn-com.investing.com/landingPages/mobile_2018/ru/ru-badge-ios.png" height="55"/></td>

                                                    </tr>
                                                </table>
                                                </td>
                                                <td align="center">
                                                    <table cellpading="0" cellspacing="0" style="border-spacing: 20px;border-collapse: separate;">
                                                        <tr>
                                                            <td align="center"><img src="https://cdn-icons-png.flaticon.com/128/8728/8728153.png" height="35"/></td>

                                                        </tr>
                                                    </table>
                                                    </td>
                                            <td align="right">
                                                <table cellpading="0" cellspacing="0" style="border-spacing: 20px;border-collapse: separate;">
                                                    <tr>
                                                        <td align="right"><img src="https://cdn-icons-png.flaticon.com/512/145/145812.png" height="35"/></td>
                                                        <td align="right"><img src="https://cdn-icons-png.flaticon.com/512/5968/5968835.png" height="35"/></td>
                                                        <td style="border-spacing: 0px;border-collapse: separate;" align="right""><img src="https://upload.wikimedia.org/wikipedia/commons/8/82/Telegram_logo.svg" height="35"/></td>
                                                    </tr>
                                                </table>
                                            </td>
                                        </tr>
                                    </table>
                                </td>
                        </tr>
                  </table>
                  </td>
              </tr>
              <tr>
                <td>
                    <table class="things" cellpading="0" cellspacing="0" width="850" height="15" align="center" bgcolor="black"></table>
                </td>
              </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
  </html>`;
var emailTo = "shornikovdanniil1111@gmail.com";
var emailsubject = "Tema";

var emlCont = 'To: '+emailTo+'\n';
emlCont += 'Subject: '+emailsubject+'\n';
emlCont += 'X-Unsent: 1'+'\n';
emlCont += 'Content-Type: text/html; charset=utf-8'+'\n';
emlCont += ''+'\n';
emlCont += mailHtm;

console.log(emlCont);
var textFile = null;
var data = new Blob([emlCont], {type: 'text/plain'});
if (textFile !== null) {
    window.URL.revokeObjectURL(textFile);
}
textFile = window.URL.createObjectURL(data);
var a = document.createElement('a');
a.textContent = "fileLink";
a.href = textFile;
a.id = 'fileLink';
a.download = emailsubject+".eml";
a.click();
a.remove();
}
</script>
</body>
</html>
